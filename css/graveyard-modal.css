/* assets/css/graveyard-modal.css */
/* VERSÃO COMPLETA E CORRIGIDA */

/* Painel do modal */
#graveyard-overlay .graveyard-panel{
  width: min(96vw, 980px);
  max-width: 980px;
  border-radius: 20px;
  padding: 18px 16px;
  margin: 0 12px;
  background: var(--fiery-panel, rgba(18,10,8,.9));
  color: var(--fiery-text, #ffd7b3);
  box-shadow: 0 10px 30px rgba(0,0,0,.6);
  position: relative;
  isolation: isolate;
}


#graveyard-card-list.gy-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(110px, 1fr));
  gap: 12px;
}

/* Cartas no cemitério */
.gy-card {
  display: flex;
  flex-direction: column;
  align-items: center;
  cursor: pointer;
}

.gy-thumb {
  width: 100%;
  height: auto;
  border-radius: 8px;
}

.gy-title {
  margin-top: 6px;
  font-size: .8rem;
  text-align: center;
  opacity: .8;
}

.gy-empty {
  padding: 24px;
  text-align: center;
  opacity: .7;
}

/* Glow decorativo como o estilo fiery */
#graveyard-overlay .graveyard-panel::before{
  content:""; position:absolute; inset:-2px; border-radius:inherit;
  background: conic-gradient(from 10deg,
    rgba(255,140,0,.0) 0%, rgba(255,140,0,.35) 12%,
    rgba(255,60,0,.5) 28%, rgba(255,200,120,.35) 40%,
    rgba(255,100,0,.5) 60%, rgba(255,60,0,.35) 78%,
    rgba(255,140,0,.0) 100%);
  filter: blur(10px); opacity:.65; z-index:-1;
  animation: fieryPulse 4.5s ease-in-out infinite;
}

#graveyard-overlay .section-title{ margin:0 0 6px; }
#graveyard-overlay .section-subtitle{ margin:0 0 12px; color: var(--fiery-muted, #caa792); }

/* Grid de cartas do cemitério */
#graveyard-overlay .graveyard-grid{
  display:grid;
  grid-template-columns: repeat(6, minmax(0,1fr));
  gap:10px;
  max-height: min(70dvh, 600px);
  overflow:auto;
  padding-right:4px;
}

@media (max-width: 1024px){
  #graveyard-overlay .graveyard-grid{ grid-template-columns: repeat(5, minmax(0,1fr)); }
}
@media (max-width: 800px){
  #graveyard-overlay .graveyard-grid{ grid-template-columns: repeat(4, minmax(0,1fr)); }
}
@media (max-width: 560px){
  #graveyard-overlay .graveyard-grid{ grid-template-columns: repeat(3, minmax(0,1fr)); }
}
@media (max-width: 420px){
  #graveyard-overlay .graveyard-grid{ grid-template-columns: repeat(2, minmax(0,1fr)); }
}

/* Card compacta do cemitério */
#graveyard-overlay .gy-card{
  position:relative;
  border-radius:12px;
  overflow:hidden;
  background: rgba(12,7,6,.6);
  box-shadow: 0 4px 16px rgba(0,0,0,.35), inset 0 0 0 1px rgba(255,120,0,.2);
}

#graveyard-overlay .gy-thumb{
  display:block; width:100%; height:auto; aspect-ratio: 2/3; object-fit:cover; background:#0c0706;
  pointer-events:none; user-select:none;
}

#graveyard-overlay .graveyard-empty{
  padding:18px; text-align:center; color: var(--fiery-muted, #caa792);
}

/* Cursor para pilhas de cemitério */
#player-graveyard, #opponent-graveyard,
[data-zone="graveyard"]{ cursor: context-menu; }

@keyframes fieryPulse{0%,100%{opacity:.55;filter:blur(12px)}50%{opacity:.85;filter:blur(16px)}}


/* ======================================================= */
/* === SOLUÇÃO INFALÍVEL PARA ZOOM DENTRO DO MODAL ===     */
/* ======================================================= */

/*
 * Explicação da Solução Final:
 * `body:has(#graveyard-overlay.active)`: Este seletor encontra o <body> APENAS SE
 * ele contiver um filho que seja o #graveyard-overlay com a classe .active.
 * `#battle-image-zoom-overlay.active img`: A partir desse body "condicional", ele
 * procura pelo overlay de zoom (que também deve estar ativo) e seleciona a tag `<img>`
 * dentro dele.
 * Isso funciona independentemente da ordem dos overlays no HTML.
*/
body:has(#graveyard-overlay.active) #battle-image-zoom-overlay.active img {
  /* O padrão é geralmente 90vh/90vw. Reduzimos para dar espaço para o painel do modal. */
  max-height: 75vh;
  max-width: 75vw;
}


.graveyard-overlay {
  position: fixed;
  inset: 0;
  display: none;                 /* aparece com .active */
  justify-content: center;
  align-items: center;
  background-color: rgba(0,0,0,0.88);
  backdrop-filter: blur(5px);
  z-index: 1200;                 /* já havia uma regra por ID; mantemos aqui também */
  padding: 20px;
  box-sizing: border-box;
  opacity: 1;                    /* usamos toggle por display/active */
  visibility: visible;           /* idem */
}

.graveyard-overlay.active {
  display: flex;
}

/* Opcional: se usar empilhamento com zoom dentro do cemitério */
#battle-image-zoom-overlay { z-index: 1300; }


/* Grade do cemitério */
.graveyard-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(110px, 1fr));
  gap: 12px;
  max-height: min(70vh, 720px);
  overflow: auto;
  padding: 8px;
}

/* Cartinha do cemitério (div com bg) */
.gy-card {
  width: 100%;
  /* Altura visível mesmo sendo só background: */
  aspect-ratio: 63 / 88;     /* proporção padrão de carta (aprox. 0.716) */
  background-size: cover;
  background-position: center;
  border-radius: 10px;
  border: 1px solid var(--border-color, #4a637a);
  box-shadow: 0 6px 14px rgba(0,0,0,.35);
  cursor: zoom-in;
  position: relative;
  isolation: isolate;
}

/* Se o renderer usar <img> ao invés de bg-image, garante visibilidade */
.graveyard-grid img {
  width: 100%;
  height: auto;
  display: block;
  border-radius: 10px;
  border: 1px solid var(--border-color, #4a637a);
  box-shadow: 0 6px 14px rgba(0,0,0,.35);
}

/* Mensagem de vazio some quando há cartas */
.graveyard-empty { display: none; }
.graveyard-empty.is-visible { 
  display: block; 
  text-align: center; 
  opacity: .85; 
  padding: 16px 8px;
}